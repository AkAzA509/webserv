<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>WebServ</title>
  <style>
    body { font-family: sans-serif; max-width: 600px; margin: 40px auto; }
    section { border: 1px solid #ccc; border-radius: 6px; padding: 15px; margin: 20px 0; }
    button { padding: 8px 16px; font-size: 16px; margin-top: 10px; }
    input[type="file"] { margin-top: 10px; }
    pre { background: #f0f0f0; padding: 10px; white-space: pre-wrap; }
    label { font-weight: bold; display: block; margin-top: 10px; }
    input[type="text"] { width: 100%; padding: 6px; margin-top: 5px; }
  </style>
  <meta charset="UTF-8">
  <title>WebServ</title>
  <style>
    body { font-family: sans-serif; max-width: 600px; margin: 40px auto; }
    section { border: 1px solid #ccc; border-radius: 6px; padding: 15px; margin: 20px 0; }
    button { padding: 8px 16px; font-size: 16px; margin-top: 10px; }
    input[type="file"] { margin-top: 10px; }
    pre { background: #f0f0f0; padding: 10px; white-space: pre-wrap; }
    label { font-weight: bold; display: block; margin-top: 10px; }
    input[type="text"] { width: 100%; padding: 6px; margin-top: 5px; }
  </style>
</head>
<body>
  <h1>Voici notre site pour tester WebServ</h1>

  <section>
  <h2>POST</h2>
  <form action="/post_file" method="POST" enctype="multipart/form-data">
    <input type="file" name="file" required>
    <button type="submit">Envoyer POST</button>
  </form>
  <button onclick="sendDelete('/post_file/')">DELETE sur /post_file/</button>
</section>



  <div class="container">
    <h2>Select a Color to Change the Page Background</h2>
    <form action="./cgi-bin/change_color.sh" method="post">
        <label for="color">Choose a color:</label>
        <select id="color" name="color">
            <option value="red">Red</option>
            <option value="blue">Blue</option>
            <option value="green">Green</option>
            <option value="yellow">Yellow</option>
            <option value="purple">Purple</option>
        </select>
        <br><br>
        <input class="button" type="submit" value="Submit">
    </form>
  </div>

	<section>
	<h2>PUT</h2>
	<input type="file" id="putFile" required>
	<button onclick="sendMultipartPut()">Envoyer PUT</button>
	<button onclick="sendDelete('/put_file/')">DELETE sur /put_file/</button>
	</section>

	<section>
    <h2>DELETE</h2>
    <button onclick="sendRequest('DELETE')">Envoyer DELETE</button>
  </section>


  <section>
    <h2>Résultat</h2>
    <pre id="result">Aucune requête encore envoyée.</pre>
  </section>

  <script>
  function sendDelete(location) {
    // Ici tu peux demander le nom du fichier à supprimer, ou lister les fichiers comme vu précédemment
    const filename = prompt('Nom du fichier à supprimer dans ' + location + ' ?');
    if (!filename) return;
    fetch(location + filename, { method: 'DELETE' })
      .then(async res => {
        const text = await res.text();
        document.getElementById('result').textContent =
          `DELETE ${res.status} ${res.statusText}\n\n${text}`;
      })
      .catch(err => {
        document.getElementById('result').textContent = 'Erreur : ' + err;
      });
  	}
    function sendRequest(method) {
      fetch('/', { method: method })
        .then(async res => {
          const text = await res.text();
          document.getElementById('result').textContent =
            `${method} ${res.status} ${res.statusText}\n\n${text}`;
        })
        .catch(err => {
          document.getElementById('result').textContent = 'Erreur : ' + err;
        });
    }

    function sendMultipartPut() {
      const fileInput = document.getElementById('putFile');
      const file = fileInput.files[0];
      if (!file) {
        alert('Aucun fichier sélectionné');
        return;
      }

      const formData = new FormData();
      formData.append('file', file); // même champ que celui attendu côté serveur

      fetch('/put_file', {
        method: 'PUT',
        body: formData
      })
      .then(async res => {
        const text = await res.text();
        document.getElementById('result').textContent =
          `PUT ${res.status} ${res.statusText}\n\n${text}`;
      })
      .catch(err => {
        document.getElementById('result').textContent = 'Erreur : ' + err;
      });
    }
  </script>
</body>
</html>
